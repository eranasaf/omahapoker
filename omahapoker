<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PLO Pre-Flop GTO Trainer</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #0f172a; color: white; font-family: system-ui, sans-serif; }
        .playing-card { background: white; color: black; border-radius: 8px; width: 60px; height: 85px; display: flex; flex-direction: column; align-items: center; justify-content: center; font-weight: bold; font-size: 1.4rem; box-shadow: 0 4px 10px rgba(0,0,0,0.5); }
        .table-ring { border: 10px solid #3e2723; border-radius: 200px; background: radial-gradient(circle, #2e7d32 0%, #1b5e20 100%); width: 100%; max-width: 500px; height: 300px; margin: 20px auto; position: relative; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- ×œ×•×’×™×§×” ××“×¢×™×ª (××”×§×•×‘×¥ ×”××§×•×¨×™ ×©×œ×š) ---
        const ranks = ['A', 'K', 'Q', 'J', 'T', '9', '8', '7', '6', '5', '4', '3', '2'];
        const suits = ['â™ ', 'â™¥', 'â™¦', 'â™£'];
        const suitColors = { 'â™ ': '#000', 'â™¥': '#dc2626', 'â™¦': '#2563eb', 'â™£': '#16a34a' };
        const positions = ['UTG', 'UTG+1', 'MP', 'CO', 'BTN', 'SB', 'BB'];
        const stackDepths = { 'short': 40, 'medium': 100, 'deep': 250 };

        const calculatePLOEquity = (cards) => {
            const rankValues = { 'A': 14, 'K': 13, 'Q': 12, 'J': 11, 'T': 10, '9': 9, '8': 8, '7': 7, '6': 6, '5': 5, '4': 4, '3': 3, '2': 2 };
            const numValues = cards.map(c => rankValues[c.rank]).sort((a, b) => b - a);
            let equity = 40;
            const avgRank = numValues.reduce((a, b) => a + b, 0) / 4;
            equity += (avgRank - 7) * 2.5;
            
            // ×‘×“×™×§×ª Suitedness
            const suitCounts = {};
            cards.forEach(c => suitCounts[c.suit] = (suitCounts[c.suit] || 0) + 1);
            const maxSuits = Math.max(...Object.values(suitCounts));
            if (maxSuits === 2) equity += 8; // Double suited potential
            if (maxSuits === 4) equity -= 5; // Rainbow
            
            return Math.round(Math.max(32, Math.min(70, equity)));
        };

        const App = () => {
            const [gameState, setGameState] = useState({
                hand: [],
                pos: 'BTN',
                stack: 'medium',
                scen: 'unopened',
                feedback: null,
                score: { correct: 0, total: 0 }
            });

            const newHand = () => {
                const h = [];
                const used = new Set();
                while(h.length < 4) {
                    const r = ranks[Math.floor(Math.random()*ranks.length)];
                    const s = suits[Math.floor(Math.random()*suits.length)];
                    if(!used.has(r+s)) { h.push({rank: r, suit: s}); used.add(r+s); }
                }
                setGameState(prev => ({
                    ...prev,
                    hand: h,
                    pos: positions[Math.floor(Math.random()*positions.length)],
                    stack: ['short', 'medium', 'deep'][Math.floor(Math.random()*3)],
                    scen: Math.random() > 0.5 ? 'unopened' : 'facing-raise',
                    feedback: null
                }));
            };

            useEffect(() => { newHand(); }, []);

            const handleAction = (userAction) => {
                const eq = calculatePLOEquity(gameState.hand);
                let correctAction = 'Fold';
                
                // ×œ×•×’×™×§×ª ×”×—×œ×˜×” ××¤×•×©×˜×ª ××‘×•×¡×¡×ª Equity ×•××™×§×•× (×œ×¤×™ ×”××§×•×¨ ×©×œ×š)
                if (gameState.pos === 'BTN' || gameState.pos === 'CO') {
                    if (eq > 45) correctAction = 'Raise';
                } else if (eq > 55) {
                    correctAction = 'Raise';
                }

                if (gameState.pos === 'BB' && gameState.scen === 'facing-raise' && eq > 40) {
                    correctAction = 'Call';
                }

                const isCorrect = userAction === correctAction;
                setGameState(prev => ({
                    ...prev,
                    feedback: { isCorrect, correctAction, eq },
                    score: { correct: prev.score.correct + (isCorrect ? 1 : 0), total: prev.score.total + 1 }
                }));

                setTimeout(newHand, 2500);
            };

            return (
                <div className="flex flex-col items-center p-4">
                    <div className="w-full max-w-xl bg-slate-800 rounded-3xl p-6 shadow-2xl border border-slate-700">
                        <div className="flex justify-between items-center mb-6">
                            <div className="bg-slate-700 px-4 py-2 rounded-full font-bold">
                                ğŸ† {gameState.score.correct} / {gameState.score.total}
                            </div>
                            <div className="text-blue-400 font-bold uppercase tracking-widest text-sm">
                                {gameState.stack.toUpperCase()} ({stackDepths[gameState.stack]}BB)
                            </div>
                        </div>

                        <div className="table-ring flex items-center justify-center">
                            <div className="text-center">
                                <div className="text-5xl font-black mb-2">{gameState.pos}</div>
                                <div className="text-sm opacity-70 italic">{gameState.scen === 'unopened' ? 'Pot is Clean' : 'Facing 3x Raise'}</div>
                            </div>
                        </div>

                        <div className="flex justify-center gap-2 -mt-12 mb-10 relative z-10">
                            {gameState.hand.map((c, i) => (
                                <div key={i} className="playing-card">
                                    <span>{c.rank}</span>
                                    <span style={{ color: suitColors[c.suit] }}>{c.suit}</span>
                                </div>
                            ))}
                        </div>

                        {!gameState.feedback ? (
                            <div className="grid grid-cols-3 gap-3">
                                <button onClick={() => handleAction('Fold')} className="bg-red-600 hover:bg-red-500 py-4 rounded-xl font-bold">FOLD</button>
                                <button onClick={() => handleAction('Call')} className="bg-blue-600 hover:bg-blue-500 py-4 rounded-xl font-bold">CALL</button>
                                <button onClick={() => handleAction('Raise')} className="bg-green-600 hover:bg-green-500 py-4 rounded-xl font-bold">RAISE</button>
                            </div>
                        ) : (
                            <div className={`p-4 rounded-xl text-center font-bold text-xl animate-bounce ${gameState.feedback.isCorrect ? 'bg-green-500/20 text-green-400' : 'bg-red-500/20 text-red-400'}`}>
                                {gameState.feedback.isCorrect ? '× ×›×•×Ÿ ×××•×“!' : `×˜×¢×•×ª. ×¢×“×™×£ ${gameState.feedback.correctAction}`}
                                <div className="text-xs mt-1">Hand Equity: {gameState.feedback.eq}%</div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
